{
  "description": "Create a new account",
  "required": true,
  "content": {
    "application/json": {
      "schema": {
        "allOf": [
          {
            "type": "object",
            "required": [
              "product_id",
              "rate"
            ],
            "properties": {
              "product": {
                "description": "The product associated with the account",
                "$ref": "#/components/schemas/Product_MVP"
              },
              "external_account_ids": {
                "type": "array",
                "description": "An Array of External Account IDs. These should be used to connect accounts created in Canopy to Users in your system and any connected external systems.",
                "items": {
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string",
                      "description": "Name of the External Party",
                      "example": "Umbrella Corporation"
                    },
                    "id": {
                      "type": "string",
                      "description": "External Account ID",
                      "example": "22445702-a389-431f-927d-07b8d0750787"
                    }
                  }
                }
              },
              "credit_limit_cents": {
                "type": "integer",
                "description": "For credit products, the total Amount (in cents) that this account can borrow. This field is not necessary for installment products.",
                "example": "400000"
              },
              "rate": {
                "type": "number",
                "description": "The percentage interest applied to the account (i.e. 6.2 means 6.2%)",
                "example": "6.2"
              },
              "original_loan_amount_cents": {
                "type": "integer",
                "description": "For installment loans, the loan amount for the first loan created for the account.",
                "example": "40000"
              },
              "offer_id": {
                "type": "string",
                "format": "uuid",
                "description": "For installment loans, the offer_id of the offer applied to the first loan created for the account. This field is not necessary for credit products. If left blank, the default offer will be applied.",
                "example": "a1c265f4-54a5-443b-b361-677a0e524419"
              }
            }
          },
          {
            "type": "object",
            "properties": {
              "existing_customers": {
                "type": "array",
                "description": "Array of existing customer IDs to be added to the account. At least one existing *OR* one new customer must be included in account creation.",
                "items": {
                  "type": "object",
                  "properties": {
                    "customer_id": {
                      "type": "string",
                      "format": "uuid",
                      "description": "Canopy-generated unique ID for this customer",
                      "example": "d581a0aa-5e11-473c-9569-64bc3a494287"
                    },
                    "customer_account_role": {
                      "type": "string",
                      "description": "The role of the customer for the account.",
                      "enum": ["primary", "secondary"],
                      "example": "primary"
                    }
                  }
                }
              }
            }
          }
        ]
      }
    }
  }
}